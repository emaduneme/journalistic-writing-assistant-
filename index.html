<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News Check: Journalistic Writing Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for the report cards and icons */
        .report-card {
            transition: all 0.3s ease-in-out;
        }
        .report-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .feedback-list li {
            position: relative;
            padding-left: 1.5rem;
        }
        .feedback-list li::before {
            content: 'â€¢';
            position: absolute;
            left: 0;
            color: #4f46e5;
        }
        #spinner {
            display: none;
            border: 4px solid rgba(0, 0, 0, .1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: #4f46e5;
            animation: spin 1s ease infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto px-4 py-8 md:py-12">
        <!-- Header Section -->
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-900">News Check</h1>
            <p class="mt-2 text-lg text-gray-600"> Writing Assistant For Journalists</p>
        </header>

        <!-- Main Application -->
        <main class="max-w-4xl mx-auto">
            <div class="bg-white p-6 rounded-2xl shadow-lg">
                <label for="text-input" class="block text-sm font-medium text-gray-700 mb-2">Paste your article, press release, or any text below:</label>
                <textarea id="text-input" rows="15" class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="Start writing or paste your text here..."></textarea>
                <div class="mt-4 text-center">
                    <button id="analyze-btn" class="bg-indigo-600 text-white font-semibold py-3 px-8 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-transform transform hover:scale-105 inline-flex items-center">
                        <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75" />
                        </svg>
                        Analyze Text
                    </button>
                </div>
            </div>

            <!-- Loading Spinner -->
            <div id="spinner-container" class="text-center py-8 hidden">
                 <div id="spinner" class="mx-auto"></div>
                 <p class="mt-2 text-gray-600">Analyzing your text...</p>
            </div>

            <!-- Report Section -->
            <div id="report-section" class="mt-10 hidden">
                <h2 class="text-3xl font-bold text-center mb-8">Analysis Report</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    
                    <!-- Readability Card -->
                    <div id="readability-card" class="bg-white p-6 rounded-2xl shadow-md report-card"></div>
                    
                    <!-- Grammar & Style Card -->
                    <div id="grammar-card" class="bg-white p-6 rounded-2xl shadow-md report-card"></div>
                    
                    <!-- Missing Info (5Ws) Card -->
                    <div id="missing-info-card" class="bg-white p-6 rounded-2xl shadow-md report-card"></div>
                    
                    <!-- Bias Check Card -->
                    <div id="bias-card" class="bg-white p-6 rounded-2xl shadow-md report-card"></div>

                    <!-- Buried Lede Card -->
                    <div id="lede-card" class="bg-white p-6 rounded-2xl shadow-md report-card md:col-span-2"></div>

                </div>
            </div>
        </main>
    </div>

    <script>
        // --- DOM Elements ---
        const analyzeBtn = document.getElementById('analyze-btn');
        const textInput = document.getElementById('text-input');
        const reportSection = document.getElementById('report-section');
        const spinnerContainer = document.getElementById('spinner-container');
        
        const readabilityCard = document.getElementById('readability-card');
        const grammarCard = document.getElementById('grammar-card');
        const missingInfoCard = document.getElementById('missing-info-card');
        const biasCard = document.getElementById('bias-card');
        const ledeCard = document.getElementById('lede-card');

        // --- Event Listener ---
        analyzeBtn.addEventListener('click', () => {
            const text = textInput.value;
            if (text.trim() === '') {
                alert('Please enter some text to analyze.');
                return;
            }
            
            // Show spinner and hide old report
            spinnerContainer.style.display = 'block';
            reportSection.style.display = 'none';
            analyzeBtn.disabled = true;
            analyzeBtn.classList.add('opacity-50', 'cursor-not-allowed');

            // Simulate analysis time to show spinner
            setTimeout(() => {
                runAnalysis(text);
                spinnerContainer.style.display = 'none';
                reportSection.style.display = 'block';
                window.scrollTo({ top: reportSection.offsetTop, behavior: 'smooth' });
                analyzeBtn.disabled = false;
                analyzeBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            }, 1000);
        });

        // --- Main Analysis Function ---
        function runAnalysis(text) {
            // 1. Readability Analysis
            const readabilityReport = checkReadability(text);
            renderCard(readabilityCard, readabilityReport);

            // 2. Grammar & Style Analysis
            const grammarReport = checkGrammarAndStyle(text);
            renderCard(grammarCard, grammarReport);

            // 3. Missing Info (5Ws) Analysis
            const missingInfoReport = checkFiveWs(text);
            renderCard(missingInfoCard, missingInfoReport);

            // 4. Bias Analysis
            const biasReport = checkBias(text);
            renderCard(biasCard, biasReport);

            // 5. Buried Lede Analysis
            const ledeReport = checkBuriedLede(text);
            renderCard(ledeCard, ledeReport);
        }

        // --- Helper function to render report cards ---
        function renderCard(cardElement, reportData) {
            let feedbackHTML = '<ul class="mt-4 space-y-2 text-gray-600 feedback-list">';
            reportData.feedback.forEach(item => {
                feedbackHTML += `<li>${item}</li>`;
            });
            feedbackHTML += '</ul>';
            
            cardElement.innerHTML = `
                <div class="flex items-center">
                    ${reportData.icon}
                    <h3 class="text-xl font-semibold ml-3">${reportData.title}</h3>
                </div>
                <p class="mt-2 text-2xl font-bold ${reportData.color}">${reportData.score}</p>
                <div class="mt-4 text-sm">
                    <p class="font-medium text-gray-700">${reportData.summary}</p>
                    ${reportData.feedback.length > 0 ? feedbackHTML : ''}
                </div>
            `;
        }

        // --- Analysis Modules ---

        // 1. READABILITY CHECK (Flesch-Kincaid)
        function checkReadability(text) {
            const words = text.match(/\b\w+\b/g) || [];
            const sentences = text.match(/[^.!?]+[.!?]+/g) || [];
            const wordCount = words.length;
            const sentenceCount = sentences.length;

            if (wordCount < 10 || sentenceCount < 1) {
                return {
                    title: "Readability",
                    icon: `<svg class="w-8 h-8 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg>`,
                    score: "Not Enough Text",
                    color: "text-gray-500",
                    summary: "Please provide more text for an accurate readability score.",
                    feedback: []
                };
            }

            let syllableCount = 0;
            words.forEach(word => {
                syllableCount += countSyllables(word);
            });

            const gradeLevel = (0.39 * (wordCount / sentenceCount)) + (11.8 * (syllableCount / wordCount)) - 15.59;
            const score = `Grade ${Math.round(gradeLevel)}`;
            
            let summary, color, feedback = [];
            if (gradeLevel <= 8) {
                summary = "Excellent! This is highly readable and accessible to a broad audience.";
                color = "text-green-600";
            } else if (gradeLevel <= 12) {
                summary = "Good. This is clear for most readers, but could be simplified.";
                color = "text-yellow-600";
                feedback.push("Try breaking down longer sentences or replacing complex words.");
            } else {
                summary = "Complex. This may be difficult for a general audience to understand.";
                color = "text-red-600";
                feedback.push("Your sentences or words might be too long. Aim for clarity and conciseness.");
            }

            return {
                title: "Readability",
                icon: `<svg class="w-8 h-8 text-indigo-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg>`,
                score: score,
                color: color,
                summary: summary,
                feedback: feedback
            };
        }
        function countSyllables(word) {
            word = word.toLowerCase();
            if (word.length <= 3) { return 1; }
            word = word.replace(/(?:[^laeiouy]es|ed|[^laeiouy]e)$/, '');
            word = word.replace(/^y/, '');
            const matches = word.match(/[aeiouy]{1,2}/g);
            return matches ? matches.length : 0;
        }

        // 2. GRAMMAR & STYLE CHECK
        function checkGrammarAndStyle(text) {
            let feedback = [];
            // Passive voice check
            const passiveRegex = /\b(am|are|is|was|were|be|being|been)\b\s*(\w+ed|[\w]+en)\b/gi;
            const passives = text.match(passiveRegex);
            if (passives && passives.length > 2) {
                feedback.push(`Found ${passives.length} potential uses of passive voice (e.g., "${passives[0]}"). <strong>Example:</strong> Instead of "The bill was passed by the Senate," write "The Senate passed the bill."`);
            }
            
            // Weak words check
            const weakWords = ['very', 'really', 'just', 'basically', 'actually', 'quite', 'somewhat'];
            let foundWeakWords = [];
            weakWords.forEach(word => {
                const regex = new RegExp(`\\b${word}\\b`, 'gi');
                if (text.match(regex)) {
                    foundWeakWords.push(word);
                }
            });
            if (foundWeakWords.length > 0) {
                feedback.push(`Consider removing or replacing weak words like: <strong>${foundWeakWords.join(', ')}</strong>. They often add little meaning.`);
            }

            let score = "Good";
            let color = "text-green-600";
            if (feedback.length > 0) {
                score = "Needs Review";
                color = "text-yellow-600";
            }
            if (feedback.length > 2) {
                score = "Needs Improvement";
                color = "text-red-600";
            }

            return {
                title: "Grammar & Style",
                icon: `<svg class="w-8 h-8 text-indigo-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125" /></svg>`,
                score: score,
                color: color,
                summary: "Checks for common journalistic style issues like passive voice and weak words.",
                feedback: feedback
            };
        }

        // 3. MISSING INFO (5Ws) CHECK
        function checkFiveWs(text) {
            const firstParagraphs = text.split('\n').slice(0, 3).join(' ');
            let feedback = [];
            let foundCount = 0;
            
            const checks = {
                'Who': /\b(mr|mrs|ms|dr|ceo|mayor|spokesperson|[A-Z][a-z]+ [A-Z][a-z]+)\b/,
                'What': /\b(announced|said|reported|discovered|crashed|won|lost|built)\b/i,
                'When': /\b(monday|tuesday|wednesday|thursday|friday|saturday|sunday|january|february|march|april|may|june|july|august|september|october|november|december|today|yesterday|tomorrow|\d{1,2}:\d{2})\b/i,
                'Where': /\b(at|in|on)\s(the\s)?[A-Z][a-z]+( [A-Z][a-z]+)?( building| city| street| avenue| road)\b/,
                'Why/How': /\b(because|due to|as a result of|in order to|by)\b/i
            };

            for (const [key, regex] of Object.entries(checks)) {
                if (regex.test(firstParagraphs)) {
                    foundCount++;
                } else {
                    feedback.push(`The <strong>'${key}'</strong> of the story is not immediately clear in the opening paragraphs.`);
                }
            }

            let score = `${foundCount}/5 W's Found`;
            let color = "text-green-600";
            if (foundCount < 5) color = "text-yellow-600";
            if (foundCount < 3) color = "text-red-600";

            return {
                title: "Missing Information",
                icon: `<svg class="w-8 h-8 text-indigo-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607zM10.5 7.5v6m3-3h-6" /></svg>`,
                score: score,
                color: color,
                summary: "A good news lead should answer Who, What, When, Where, and Why/How.",
                feedback: feedback
            };
        }

        // 4. BIAS & IRRELEVANT INFO CHECK
        function checkBias(text) {
            let feedback = [];
            const loadedWords = ['amazing', 'shocking', 'tragic', 'miracle', 'obviously', 'clearly', 'groundbreaking', 'revolutionary', 'state-of-the-art', 'best', 'worst'];
            let foundLoadedWords = [];

            loadedWords.forEach(word => {
                const regex = new RegExp(`\\b${word}\\b`, 'gi');
                if (text.match(regex)) {
                    foundLoadedWords.push(word);
                }
            });
            
            if (foundLoadedWords.length > 0) {
                feedback.push(`Subjective or promotional words were found: <strong>${foundLoadedWords.join(', ')}</strong>. <strong>Example:</strong> Instead of "a tragic accident," describe what happened and let the facts convey the tragedy.`);
            }

            let score = "Low Bias";
            let color = "text-green-600";
            if (feedback.length > 0) {
                score = "Potential Bias";
                color = "text-yellow-600";
            }

            return {
                title: "Bias Check",
                icon: `<svg class="w-8 h-8 text-indigo-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v17.25m0 0c-1.472 0-2.882.265-4.185.75M12 20.25c1.472 0 2.882.265 4.185.75M18.75 4.97A48.416 48.416 0 0012 4.5c-2.291 0-4.545.16-6.75.47m13.5 0c1.01.143 2.01.317 3 .52m-3-.52l2.62 10.726c.122.499-.106 1.028-.589 1.202a5.988 5.988 0 01-2.153.34c-1.325 0-2.59-.383-3.628-1.035a21.44 21.44 0 00-4.252-2.324m13.5 0l-2.62 10.726m0 0l-2.62-10.726" /></svg>`,
                score: score,
                color: color,
                summary: "Checks for loaded adjectives and promotional language to ensure objectivity.",
                feedback: feedback
            };
        }
        
        // 5. BURIED LEDE CHECK
        function checkBuriedLede(text) {
            const sentences = text.match(/[^.!?]+[.!?]+/g) || [];
            if (sentences.length < 3) {
                return {
                    title: "Buried Lede",
                    icon: `<svg class="w-8 h-8 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 13.5L12 21m0 0l-7.5-7.5M12 21V3" /></svg>`,
                    score: "Not Enough Text",
                    color: "text-gray-500",
                    summary: "The most important information should be in the first sentence. More text is needed to check this.",
                    feedback: []
                };
            }

            const getSentenceScore = (sentence) => {
                let score = 0;
                if (/\b(announced|said|reported|discovered|crashed|won|lost)\b/i.test(sentence)) score += 3;
                if (/\b[A-Z][a-z]+ [A-Z][a-z]+\b/.test(sentence)) score += 2; // Proper name
                if (/\b(yesterday|today|monday|tuesday)\b/i.test(sentence)) score += 1;
                return score;
            };

            const firstSentenceScore = getSentenceScore(sentences[0]);
            let potentialLedeSentence = null;
            let highestScore = firstSentenceScore;

            for (let i = 1; i < Math.min(sentences.length, 4); i++) {
                let currentScore = getSentenceScore(sentences[i]);
                if (currentScore > highestScore + 1) { // Needs to be significantly better
                    highestScore = currentScore;
                    potentialLedeSentence = sentences[i];
                }
            }

            let feedback = [];
            let score = "Lede is Clear";
            let color = "text-green-600";
            let summary = "The most important information appears to be at the top of your article.";

            if (potentialLedeSentence) {
                score = "Potential Buried Lede";
                color = "text-red-600";
                summary = "Your first sentence might not contain the most critical information.";
                feedback.push(`This later sentence seems more direct: "<em>${potentialLedeSentence.trim()}</em>"`);
                feedback.push("<strong>Example:</strong> Ensure the absolute most newsworthy element (the core Who, What, When, Where) is in your very first sentence.");
            }

            return {
                title: "Buried Lede",
                icon: `<svg class="w-8 h-8 text-indigo-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 13.5L12 21m0 0l-7.5-7.5M12 21V3" /></svg>`,
                score: score,
                color: color,
                summary: summary,
                feedback: feedback
            };
        }

    </script>
</body>
</html>
